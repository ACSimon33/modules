#%Module
module-forbid tag/1.0 tag/2.0 tag/3.0
module-virtual tag/2.0 ./1.0
module-alias tag/3.0 tag/1.0

if {[versioncmp $tcl_version 8.5] > -1} {
    set tomorrow [clock format [expr {[clock seconds]+86400}] -format %Y-%m-%d]
    module-forbid --after $tomorrow tag/4.0
}

if {[info exists env(TESTSUITE_MODULE_TAG_ERR1)]} {
    module-tag
}
if {[info exists env(TESTSUITE_MODULE_TAG_ERR2)]} {
    module-tag foo
}
if {[info exists env(TESTSUITE_MODULE_TAG_ERR3)]} {
    module-tag --foo foo tag/5.0
}
if {[info exists env(TESTSUITE_MODULE_TAG_ERR4)]} {
    module-tag --before 2020-11-01 foo tag/5.0
}
if {[info exists env(TESTSUITE_MODULE_TAG_ERR5)]} {
    module-tag --after 2020-11-01 foo tag/5.0
}

if {[info exists env(TESTSUITE_MODULE_TAG_SET1)]} {
    module-tag foo tag/5.0 tag/6.0
}
if {[info exists env(TESTSUITE_MODULE_TAG_SET2)]} {
    module-tag foo tag@5.0 tag@6.0
}
if {[info exists env(TESTSUITE_MODULE_TAG_SET3)]} {
    module-tag foo tag @5.0 tag @6.0
}
if {[info exists env(TESTSUITE_MODULE_TAG_SET4)]} {
    module-tag foo tag @5.0 tag @6.0
    module-tag BaR tag@5:6
}
if {[info exists env(TESTSUITE_MODULE_TAG_SET5)]} {
    module-tag --not-user [module-info username] foo tag/5.0 tag/6.0
}
if {[info exists env(TESTSUITE_MODULE_TAG_SET6)]} {
    module-tag --not-user unkuser foo tag/5.0 tag/6.0
}
if {[info exists env(TESTSUITE_MODULE_TAG_SET7)]} {
    module-tag --not-group [module-info usergroups] foo tag/5.0 tag/6.0
}
if {[info exists env(TESTSUITE_MODULE_TAG_SET8)]} {
    module-tag --not-group unkgrp foo tag/5.0 tag/6.0
}
