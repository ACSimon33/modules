#%Module

module-version ./3.1 default

if {[info exists env(TESTSUITE_HIDE_ERR1)]} {
    module-hide
}
if {[info exists env(TESTSUITE_HIDE_ERR2)]} {
    module-hide @:1.2
}

if {[info exists env(TESTSUITE_HIDE_WILDCARD1)]} {
    module-hide *
}
if {[info exists env(TESTSUITE_HIDE_WILDCARD2)]} {
    module-hide hi*
}
if {[info exists env(TESTSUITE_HIDE_WILDCARD3)]} {
    module-hide hide1/4.?
}

if {[info exists env(TESTSUITE_HIDE_SET1)]} {
    module-hide hide1@1.0,3.1
}
if {[info exists env(TESTSUITE_HIDE_SET2)]} {
    module-hide hide1@5: hide1/4.0
}

# module-hide --soft tests
if {[info exists env(TESTSUITE_HIDE_SOFT_SET1)]} {
    module-hide --soft hide1@1.0,3.1
}
if {[info exists env(TESTSUITE_HIDE_SOFT_SET2)]} {
    module-hide hide1@5: --soft hide1/4.0
}

# module-hide --not-user tests
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_SET1)]} {
    module-hide --not-user [module-info username] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_SET2)]} {
    module-hide --not-user unknown hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_SET3)]} {
    module-hide --not-user [list [module-info username] unknown] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_SET4)]} {
    module-hide --not-user [list unknown1 unknown2 unknown3] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_SET5)]} {
    module-hide --not-user [list unknown1 unknown2 [module-info username] unknown3] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_SET6)]} {
    module-hide --not-user {unknown1 unknown2 unknown3} --not-user [list unknown1 unknown2 [module-info username] unknown3] hide1/5.0
}
# module-hide --not-group tests
if {[info exists env(TESTSUITE_HIDE_ALLOW_GROUP_SET1)]} {
    module-hide --not-group [module-info usergroups] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_GROUP_SET2)]} {
    module-hide --not-group unknown hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_GROUP_SET3)]} {
    module-hide --not-group [list [lindex [module-info usergroups] 0] unknown] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_GROUP_SET4)]} {
    module-hide --not-group [list unknown1 unknown2 unknown3] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_GROUP_SET5)]} {
    module-hide --not-group [list unknown1 unknown2 [lindex [module-info usergroups] end] unknown3] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_GROUP_SET6)]} {
    module-hide --not-group [concat [list unknown1 unknown2 ] [module-info usergroups]] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_GROUP_SET7)]} {
    module-hide --not-group [concat [list unknown1 unknown2 ] [module-info usergroups]] --not-group {unknown1 unknown2} hide1/5.0
}
# module-hide --not-group and --not-user tests
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_GROUP_SET1)]} {
    module-hide --not-user {unknown1 unknown2} --not-group [concat [list unknown1 unknown2 ] [module-info usergroups]] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_GROUP_SET2)]} {
    module-hide --not-user [list unknown1 [module-info username] unknown2] --not-group {unknown1 unknown2 unknown3} hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_GROUP_SET3)]} {
    module-hide --not-group {unknown1 unknown2} --not-user {unknown1 unknown2 unknown3} hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_GROUP_SET4)]} {
    module-hide --not-group [list [lindex [module-info usergroups] 0] unknown2] --not-user [list unknown1 [module-info username] unknown3] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_GROUP_ERR_SET1)]} {
    module-hide --not-group hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_GROUP_ERR_SET2)]} {
    module-hide --not-group hide1/5.0 --not-user
}
if {[info exists env(TESTSUITE_HIDE_ALLOW_USER_GROUP_ERR_SET3)]} {
    module-hide --not-group
}

# 20/119 module-hide/module-forbid cascading tests
if {[info exists env(TESTSUITE_HIDE1_CASC_SET1)]} {
    module-hide --soft hide1
}
if {[info exists env(TESTSUITE_HIDE1_CASC_SET2)]} {
    module-hide hide1
}
if {[info exists env(TESTSUITE_HIDE1_CASC_SET3)]} {
    module-hide hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE1_CASC_SET4)]} {
    module-hide --soft hide1
}

if {[info exists env(TESTSUITE_HIDE1_CASC2_SET1)]} {
    module-hide --not-user [module-info username] hide1
}
if {[info exists env(TESTSUITE_HIDE1_CASC2_SET2)]} {
    module-hide hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE1_CASC2_SET3)]} {
    module-hide hide1
}
if {[info exists env(TESTSUITE_HIDE1_CASC2_SET4)]} {
    module-hide --not-user [module-info username] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE1_CASC2_SET5)]} {
    module-hide --not-user [module-info username] hide1
}
if {[info exists env(TESTSUITE_HIDE1_CASC2_SET6)]} {
    module-hide --soft hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE1_CASC2_SET7)]} {
    module-hide hide1
}
if {[info exists env(TESTSUITE_HIDE1_CASC2_SET8)]} {
    module-hide --soft --not-user [module-info username] hide1/5.0
}

if {[info exists env(TESTSUITE_HIDE1_CASC3_SET1)]} {
    module-hide --not-group [module-info usergroups] hide1
}
if {[info exists env(TESTSUITE_HIDE1_CASC3_SET2)]} {
    module-hide hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE1_CASC3_SET3)]} {
    module-hide hide1
}
if {[info exists env(TESTSUITE_HIDE1_CASC3_SET4)]} {
    module-hide --not-group [module-info usergroups] hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE1_CASC3_SET5)]} {
    module-hide --not-group [module-info usergroups] hide1
}
if {[info exists env(TESTSUITE_HIDE1_CASC3_SET6)]} {
    module-hide --soft hide1/5.0
}
if {[info exists env(TESTSUITE_HIDE1_CASC3_SET7)]} {
    module-hide hide1
}
if {[info exists env(TESTSUITE_HIDE1_CASC3_SET8)]} {
    module-hide --soft --not-group [module-info usergroups] hide1/5.0
}
